<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>æƒ…ä¹¦é¡µé¢</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: "æ€æºå®‹ä½“","å®‹ä½“",serif;
      /* background: url('backgroud.png') no-repeat center center fixed; */
      background-size: cover; /* å…¶ä»–é€‰é¡¹: contain(å®Œæ•´æ˜¾ç¤º), 100% 100%(æ‹‰ä¼¸å¡«æ»¡) */
    }

    /* æ°”æ³¡æ ·å¼ */
    .bubble {
      position: absolute;
      border-radius: 50%;
      background-color: transparent;
      border: 2px solid rgba(255,255,255,0.3);
      animation: floatUp 20s infinite;
    }
    @keyframes floatUp {
      0%   { transform: translateY(100vh) scale(0.5); opacity: 0; }
      50%  { opacity: 1; }
      100% { transform: translateY(-10vh) scale(1); opacity: 0; }
    }
    .bubble-container {
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      overflow: hidden; pointer-events: none;
    }

    /* æ–‡å­—æ¡† */
    .text-box {
      position: absolute; 
      top: 50%; 
      left: 50%;
      transform: translate(-50%, -50%);
      width: 520px; 
      max-height: 60vh;
      padding: 40px 30px;
      overflow-y: auto;
      background: rgba(255,255,255,0.75);
      border-radius: 20px;
      box-shadow: 0 0 25px rgba(0,0,0,0.25);
      backdrop-filter: blur(3px);
      z-index: 10;
    }
    .text-box h2 {
      margin: 0 0 20px;
      text-align: center;
      color: #822b82;
      font-family: "åæ–‡è¡Œæ¥·", cursive;
      font-size: 28px;
      letter-spacing: 2px;
      text-shadow: 1px 1px 2px #fff;
    }
    #typingText {
      font-size: 22px;
      color: #444;
      white-space: pre-wrap;
      line-height: 2;
      letter-spacing: 1px;
      text-align: justify;
      text-shadow: 0.5px 0.5px 0.5px rgba(0,0,0,0.05);
    }
    .text-box .signature{
      margin-top: 30px;
      text-align: right;
      color: #a03ca0;
      font-family: "æ¥·ä½“", Georgia, serif;
      font-size: 18px;
      letter-spacing: 1px;
    }

    /* å‰ªå½±å›¾ç‰‡ - ä¿®æ”¹åçš„æ ·å¼ */
    .silhouette{
      position: absolute; 
      bottom: 3vh; /* è·ç¦»åº•éƒ¨5%çš„è§†çª—é«˜åº¦ */
      left: 50%;
      transform: translateX(-50%); /* åªæ°´å¹³å±…ä¸­ */
      max-width: 280px;
      width: 50vw; /* ä½¿ç”¨è§†çª—å®½åº¦å•ä½ï¼Œè‡ªåŠ¨é€‚åº”å±å¹• */
      min-width: 180px; /* è®¾ç½®æœ€å°å®½åº¦ */
      height: auto; /* ä¿æŒå®½é«˜æ¯” */
      z-index: 5;
    }

    /* å“åº”å¼è®¾è®¡ - é’ˆå¯¹ä¸åŒå±å¹•å°ºå¯¸è°ƒæ•´ */
    @media screen and (max-width: 768px) {
      .silhouette {
        width: 30vw;
        min-width: 140px;
        bottom: 3vh;
      }
      .text-box {
        width: 90%;
        max-height: 55vh;
        padding: 18px 12px;
      }
    }

    @media screen and (max-width: 480px) {
      .silhouette {
        width: 35vw;
        min-width: 120px;
        bottom: 2vh;
      }
      .text-box {
        width: 95%;
        max-height: 50%;
        padding: 8px 6px;
      }
    }

    /* å…¨å±çŠ¶æ€ä¼˜åŒ– */
    @media screen and (min-width: 1200px) {
      .silhouette {
        width: 18vw;
        max-width: 250px;
        bottom: 8vh;
      }
      .text-box {
        width: 480px;
        max-height: 65vh;
      }
    }

    /* è¶…å®½å±ä¼˜åŒ– */
    @media screen and (min-width: 1600px) {
      .silhouette {
        width: 15vw;
        max-width: 280px;
        bottom: 10vh;
      }
      .text-box {
        width: 500px;
        max-height: 70vh;
      }
    }

    /* èƒŒæ™¯éŸ³ä¹æ§åˆ¶æŒ‰é’®ï¼ˆå·¦ä¸‹è§’å°åœ†ç‚¹ï¼‰ */
    .mPower{
      position: fixed; bottom: 20px; left: 20px;
      z-index: 9999;
    }
    .mPower span{
      display: inline-block;
      width: 26px; height: 26px;
      border-radius: 50%;
      background: rgba(255,107,107,0.8);
      cursor: pointer; user-select: none;
      box-shadow: 0 2px 6px rgba(255,107,107,.3);
      transition: all .3s ease;
    }
    .mPower span:hover{ transform: scale(1.15); }
    .mPower span:active{ transform: scale(.9); }

    /* å³ä¸Šè§’ â™¥ æŒ‰é’® */
    .top-right-btn{
      position: fixed; top: 20px; right: 20px;
      width: 40px; height: 40px;
      background: rgba(255,107,107,0.8);
      color:#fff; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-size:18px; cursor:pointer; user-select:none;
      box-shadow:0 2px 10px rgba(255,107,107,.3);
      transition:all .3s ease; z-index:9999;
    }
    .top-right-btn:hover   { background: rgba(255,107,107,1); transform: scale(1.1); }
    .top-right-btn:active { transform: scale(.95); }
  </style>
</head>
<body>

  <!-- æ¨±èŠ±é›¨é…ç½® -->
  <script>
    window.sakuraConfig = window.sakuraConfig || {
      sakura: 120,        // èŠ±ç“£æ•°é‡
      xSpeed: 1,       // æ°´å¹³é€Ÿåº¦
      ySpeed: 1,       // å‚ç›´é€Ÿåº¦
      rSpeed: 0.05,     // æ—‹è½¬é€Ÿåº¦
      direction: "TopRight", // å¼€å§‹æ–¹å‘
      zIndex: -1         // Z-Indexå±‚çº§
    };
  </script>

  <!-- èƒŒæ™¯éŸ³ä¹ & æ‰“å­—æœºéŸ³æ•ˆ -->
  <audio id="bgmMusic"  src="bgm.mp3"      autoplay loop preload="auto"></audio>
  <audio id="typeSound" src="typeSound.mp3" preload="auto"></audio>

  <!-- æ’­æ”¾ / æš‚åœæŒ‰é’® -->
  <div class="mPower">
    <span id="musicOn"  title="ç‚¹å‡»æš‚åœ"></span>
    <span id="musicOff" title="ç‚¹å‡»æ’­æ”¾" style="display:none;"></span>
  </div>

  <!-- çˆ±å¿ƒè§¦å‘ ESC æŒ‰é’® -->
  <div class="top-right-btn">â¤</div>

  <!-- æ°”æ³¡å®¹å™¨ -->
  <div class="bubble-container" id="bubbles"></div>

  <!-- æ–‡å­—å†…å®¹ -->
  <div class="text-box">
    <h2>å°æƒ…ä¹¦</h2>
    <div id="typingText"></div>
    <div class="signature">â€”â€” å°æ—­åŒå­¦</div>
  </div>

  <!-- å‰ªå½±å›¾ç‰‡ -->
  <img class="silhouette" src="backgroud.png" alt="å‰ªå½±">

  <!-- jQueryï¼ˆæœ¬åœ°æˆ– CDN å‡å¯ï¼‰ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <!-- èƒŒæ™¯éŸ³ä¹ / æŒ‰é’®é€»è¾‘ & ESC è§¦å‘ -->
  <script>
    $(function () {
      /* èƒŒæ™¯éŸ³ä¹æ’­æ”¾æ§åˆ¶ */
      const bgm = document.getElementById('bgmMusic');
      $('#musicOn').on('click', () => { bgm.pause(); $('#musicOn').hide(); $('#musicOff').show(); });
      $('#musicOff').on('click', () => { bgm.play();  $('#musicOff').hide(); $('#musicOn').show(); });

      /* è§£å†³è‡ªåŠ¨æ’­æ”¾é™åˆ¶ â€” é¦–æ¬¡ç‚¹å‡»é¡µé¢ååŒæ—¶æ‰“å¼€ bgm å’Œæ‰“å­—æœºéŸ³æ•ˆæƒé™ */
      window.addEventListener('click', () => {
        bgm.play().catch(()=>{});
        $('#typeSound')[0].play().then(a=>$('#typeSound')[0].pause());
      }, {once:true});

      /* å³ä¸Šè§’çˆ±å¿ƒï¼šè§¦å‘ ESC é”®è‡ªå®šä¹‰äº‹ä»¶ */
      $('.top-right-btn').on('click', () => {
        const escEvent = new KeyboardEvent('keyup', {
          key: 'Escape', keyCode: 27, which: 27, bubbles: true, cancelable: true
        });
        window.dispatchEvent(escEvent);
        $(window).trigger($.Event('keyup',{keyCode:27,which:27,target:document.body}));
      });
    });
  </script>

  <!-- æ¨±èŠ±é›¨æ•ˆæœåº“ -->
  <script>
    function loadAndExecuteScript(url) {
      fetch(url)
        .then((response) => response.text())
        .then((scriptContent) => {
          const wrappedScript = `
            (function() {
              try {
                ${scriptContent}
              } catch (e) {
                if (e instanceof SyntaxError && e.message.includes("Identifier 'isMobile' has already been declared")) {
                  console.warn("Ignored redeclaration of 'isMobile'");
                } else {
                  throw e;
                }
              }
            })();
          `;
          const script = document.createElement('script');
          script.textContent = wrappedScript;
          document.body.appendChild(script);
        })
        .catch((error) => console.error('Error loading the sakura script:', error));
    }

    function initializeSakura() {
      loadAndExecuteScript('https://cdn.jsdelivr.net/gh/minz71/sakura-rain/sakura-rain.js');
    }
  </script>

  <!-- æ°”æ³¡ + æ‰“å­—æœºä¸»è„šæœ¬ -->
  <script>
    /* ---------- æ°”æ³¡ç”Ÿæˆ ---------- */
    const colors = ['#ffb6c1','#dda0dd','#87cefa','#90ee90','#f0e68c'];
    const bubbles = document.getElementById('bubbles');
    for (let i = 0; i < 80; i++) {
      const bubble = document.createElement('div');
      const size  = Math.random() * 30 + 10;
      bubble.className = 'bubble';
      bubble.style.width = bubble.style.height = size + 'px';
      bubble.style.left = Math.random() * 100 + '%';
      bubble.style.animationDuration = (Math.random() * 10 + 10) + 's';
      bubble.style.borderColor = colors[Math.floor(Math.random() * colors.length)];
      bubbles.appendChild(bubble);
    }

    /* ---------- æ‰“å­—æœºæ•ˆæœ ---------- */
    const rawText = `åœ¨é‡è§ä½ ä¹‹å‰ï¼Œæˆ‘ä»¥ä¸ºâ€œå–œæ¬¢â€åªæ˜¯é£æ è¿‡æ¹–é¢æ—¶æ³›èµ·çš„ä¸€åœˆæ¶Ÿæ¼ªï¼Œè½»è½»è¡æ¼¾ï¼Œç»ˆå°†å½’äºå¹³é™ã€‚å¯é‡è§ä½ ä¹‹åï¼Œæˆ‘æ‰æ˜ç™½ï¼ŒåŸæ¥æœ‰äº›å¿ƒè·³åƒæ½®æ±ï¼Œæ˜¼å¤œä¸æ¯â€”â€”ä¸€ééå°†æ€å¿µæ¨å‘å²¸è¾¹ï¼Œæ‚„æ‚„ç”¨ä¸ä½ æœ‰å…³çš„æ¸©åº¦ï¼Œå¡«æ»¡äº†æˆ‘çš„æ•´ä¸ªä¸–ç•Œã€‚

æˆ‘å–œæ¬¢çœ‹åˆ°ä½ çš„ç¬‘å®¹ã€‚ä½ ç¬‘èµ·æ¥çš„æ ·å­ï¼Œåƒåˆå¤çš„é˜³å…‰æ´’è½åœ¨æ¹–é¢ï¼Œè½»ç›ˆåˆæ¸©æš–ï¼Œæ³›ç€æŸ”å…‰ã€‚çœ‹è§ä½ å¼€å¿ƒï¼Œæˆ‘ä¹Ÿä¼šè§‰å¾—ï¼Œå“ªæ€•æ‰€æœ‰çš„ç­‰å¾…ä¸æ²‰é»˜ï¼Œéƒ½æ˜¯å€¼å¾—çš„ã€‚

æ„¿æˆ‘æ‰€æœ‰çš„æ¸©æŸ”ï¼Œéƒ½æ°å¥½å»åˆä½ çš„å¿ƒäº‹ï¼›æ„¿æˆ‘æ‰€æœ‰çš„è€å¿ƒï¼Œéƒ½åªç”¨æ¥ç­‰ä½ ã€é™ªä½ â€”â€”çœ‹èŠ±å¼€èŠ±è°¢ï¼Œçœ‹æµ·æ½®å¾€å¤ï¼Œçœ‹è¿™äººé—´çƒŸç«ç¼“ç¼“æµæ·Œï¼Œä¸ä½ å…±åº¦æ¯ä¸€ä¸ªå¹³å¸¸æ—¥å­é‡Œçš„é™å¥½æ—¶å…‰ã€‚

æˆ‘æƒ³å–œæ¬¢çš„é‚£ä¸ªäººï¼Œåº”è¯¥æ˜¯çœ¼ä¸­æœ‰å…‰ã€å¿ƒä¸­æœ‰æš–çš„äººã€‚å¥¹ä¸ä¼šå¤ªå¼ æ‰¬ï¼Œå´åœ¨æ„ä»–äººçš„æ„Ÿå—ï¼›å¥¹ä¸æ€»è¯´çˆ±ï¼Œå´ç”¨è¡ŒåŠ¨å®ˆæŠ¤å½¼æ­¤çš„æ—¥å¸¸ã€‚å°±åƒä½ ä¸ç»æ„é—´æµéœ²å‡ºçš„æ¨¡æ ·ï¼Œè®©äººå¿ä¸ä½é è¿‘ï¼Œåˆæƒ³ç”¨å°½å…¨éƒ¨çš„æ¸©æŸ”çè—ã€‚

ä¹Ÿè®¸ä½ ä»æœªå¯Ÿè§‰ï¼Œå¯åœ¨é‚£äº›ä½ æœªç•™æ„çš„æ—¶åˆ»é‡Œï¼Œæˆ‘æ—©å·²æ‚„æ‚„å¯¹è‡ªå·±è¯´è¿‡æ— æ•°æ¬¡â€”â€”æˆ‘å¥½åƒï¼Œå°±æ˜¯å–œæ¬¢è¿™æ ·çš„ä½ ã€‚

æ„¿è¿™å°ä¿¡ç©¿è¶Šäººæµ·ï¼Œè½»è½»æŠµè¾¾ä½ æŸ”è½¯çš„å¿ƒåº•ã€‚æ„¿æˆ‘æ‰€æœ‰çš„åšå®šä¸æ¸©æŸ”ï¼Œç»ˆæœ‰ä¸€æ—¥èƒ½é å²¸äºä½ èº«è¾¹ï¼Œä¸ä½ å¹¶è‚©ï¼Œèµ°è¿‡æ¼«é•¿è€Œå€¼å¾—çš„äººé—´å²æœˆã€‚`;

    const formattedText = rawText.replace(/\n\n/g,'<br><br>').replace(/\n/g,'<br>');
    const target = document.getElementById('typingText');
    const typeSound = document.getElementById('typeSound');
    let i = 0, typingSpeed = 200;

    function typeWriter(){
      if(i < formattedText.length){
        const char = formattedText.charAt(i);
        if(char === '<'){ // å¤„ç† <br>
          const end = formattedText.indexOf('>', i);
          target.innerHTML += formattedText.substring(i, end+1);
          i = end+1;
        }else{
          target.innerHTML += char;
          i++;
          // æ‰“å­—æœºéŸ³æ•ˆ
          typeSound.currentTime = 0;
          typeSound.play();
        }

        // ğŸ‘‰ è‡ªåŠ¨æ»šåŠ¨åˆ°æ–‡å­—æ¡†åº•éƒ¨
        target.parentElement.scrollTop = target.parentElement.scrollHeight;

        setTimeout(typeWriter, typingSpeed);
      }
    }


    /* ---------- é¡µé¢åˆå§‹åŒ– ---------- */
    window.onload = () => { 
      setTimeout(typeWriter, 5000);
      // åˆå§‹åŒ–æ¨±èŠ±é›¨æ•ˆæœ
      setTimeout(initializeSakura, 1000);
    };
  </script>
</body>
</html>
